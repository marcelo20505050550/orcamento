(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1915],{7073:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(95155),s=r(12115),d=r(35695),o=r(6874),i=r.n(o),l=r(25731);function n(e){let{params:t}=e,r=(0,d.useRouter)(),o="true"===(0,d.useSearchParams)().get("novo"),n=(0,s.use)(t).id,[u,h]=(0,s.useState)(null),[g,p]=(0,s.useState)(!0),[y,b]=(0,s.useState)(null),[f,j]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=async()=>{p(!0);try{let e=await l.Ay.get("/api/pedidos/".concat(n));if(e.error)throw Error(e.error||"Erro ao carregar detalhes do pedido");let t=await l.Ay.get("/api/pedidos/".concat(n,"/itens-extras")),r=t.error?[]:t.data;h({...e.data,itens_extras:r})}catch(e){console.error("Erro ao buscar detalhes do pedido:",e),b(e instanceof Error?e.message:"Ocorreu um erro ao carregar os detalhes do pedido")}finally{p(!1)}};n&&e()},[n]);let w=async e=>{if(u){j(!0);try{let t=await l.Ay.put("/api/pedidos/".concat(u.id),{status:e});if(t.error)throw Error(t.error||"Erro ao atualizar status do pedido");h({...u,status:t.data.status,updated_at:t.data.updated_at})}catch(e){console.error("Erro ao atualizar status:",e),b(e instanceof Error?e.message:"Ocorreu um erro ao atualizar o status do pedido")}finally{j(!1)}}},N=e=>{let t=new Date(e);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)},k=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),v=()=>u&&u.processos.length?u.processos.reduce((e,t)=>e+t.processo.preco_por_unidade*t.quantidade,0):0,_=()=>u&&u.mao_de_obra.length?u.mao_de_obra.reduce((e,t)=>e+t.mao_de_obra.preco_por_hora*t.horas,0):0,E=()=>u&&u.itens_extras&&u.itens_extras.length?u.itens_extras.reduce((e,t)=>e+t.valor,0):0,S=e=>{let t=Math.floor(e/60),r=e%60;return 0===t?"".concat(r," minutos"):0===r?"".concat(t," ").concat(1===t?"hora":"horas"):"".concat(t," ").concat(1===t?"hora":"horas"," e ").concat(r," minutos")},C=()=>{let e=u?u.produto.preco_unitario*u.quantidade:0,t=v(),r=_();return e+t+r+E()+((null==u?void 0:u.tem_frete)&&u.valor_frete||0)},A=()=>{if(!u)return 0;let e=C(),t=u.margem_lucro_percentual;return t>0?e/((100-t)/100)-e:0},P=()=>{if(!u)return 0;let e=C(),t=u.margem_lucro_percentual;return t>0?e/((100-t)/100):e},z=()=>{if(!u)return 0;let e=P(),t=u.impostos_percentual;return t>0?e/((100-t)/100)-e:0},[I,M]=(0,s.useState)(!1),[F,O]=(0,s.useState)(!1),[T,D]=(0,s.useState)(!1),[R,L]=(0,s.useState)(!1),B=async(e,t)=>{if(u){L(!0);try{let r=await l.Ay.put("/api/pedidos/".concat(u.id),{tem_frete:e,valor_frete:t});if(r.error)throw Error(r.error||"Erro ao atualizar frete");h({...u,tem_frete:r.data.tem_frete,valor_frete:r.data.valor_frete,updated_at:r.data.updated_at}),M(!1)}catch(e){console.error("Erro ao atualizar frete:",e),b(e instanceof Error?e.message:"Erro ao atualizar frete")}finally{L(!1)}}},U=async e=>{if(u){L(!0);try{let t=await l.Ay.put("/api/pedidos/".concat(u.id),{margem_lucro_percentual:e});if(t.error)throw Error(t.error||"Erro ao atualizar margem de lucro");h({...u,margem_lucro_percentual:t.data.margem_lucro_percentual,updated_at:t.data.updated_at}),O(!1)}catch(e){console.error("Erro ao atualizar margem:",e),b(e instanceof Error?e.message:"Erro ao atualizar margem de lucro")}finally{L(!1)}}},q=async e=>{if(u){L(!0);try{let t=await l.Ay.put("/api/pedidos/".concat(u.id),{impostos_percentual:e});if(t.error)throw Error(t.error||"Erro ao atualizar impostos");h({...u,impostos_percentual:t.data.impostos_percentual,updated_at:t.data.updated_at}),D(!1)}catch(e){console.error("Erro ao atualizar impostos:",e),b(e instanceof Error?e.message:"Erro ao atualizar impostos")}finally{L(!1)}}};if(g)return(0,a.jsx)("div",{className:"p-4 flex justify-center items-center h-full",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})});if(y)return(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/30 p-4 rounded-md",children:[(0,a.jsx)("h2",{className:"text-red-800 dark:text-red-200 font-medium",children:"Erro"}),(0,a.jsx)("p",{className:"text-red-700 dark:text-red-300 mt-1",children:y}),(0,a.jsx)("button",{onClick:()=>r.push("/pedidos"),className:"mt-3 text-sm text-white bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded",children:"Voltar aos Pedidos"})]})});if(!u)return(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-md",children:[(0,a.jsx)("h2",{className:"text-yellow-800 dark:text-yellow-200 font-medium",children:"Pedido n\xe3o encontrado"}),(0,a.jsx)("p",{className:"text-yellow-700 dark:text-yellow-300 mt-1",children:"O pedido solicitado n\xe3o foi encontrado ou voc\xea n\xe3o tem permiss\xe3o para acess\xe1-lo."}),(0,a.jsx)("button",{onClick:()=>r.push("/pedidos"),className:"mt-3 text-sm text-white bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded",children:"Voltar aos Pedidos"})]})});let H=(e=>{switch(e){case"pendente":return{text:"Pendente",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200"};case"em_producao":return{text:"Em Produ\xe7\xe3o",className:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200"};case"finalizado":return{text:"Finalizado",className:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200"};case"cancelado":return{text:"Cancelado",className:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200"};default:return{text:e,className:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}}})(u.status),J=v(),G=_(),V=E();return u&&u.processos.length&&u.processos.reduce((e,t)=>e+t.processo.tempo_estimado_minutos*t.quantidade,0),(0,a.jsxs)("div",{className:"space-y-6",suppressHydrationWarning:!0,children:[o&&(0,a.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg shadow",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-blue-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3 flex-1 md:flex md:justify-between",children:[(0,a.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Pedido criado com sucesso! Para completar o or\xe7amento, adicione processos de fabrica\xe7\xe3o e m\xe3o de obra."}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-3 md:mt-0 md:ml-6",children:[(0,a.jsxs)(i(),{href:"/pedidos/".concat(null==u?void 0:u.id,"/processos"),className:"text-sm font-medium text-blue-700 dark:text-blue-300 hover:text-blue-600 dark:hover:text-blue-200 whitespace-nowrap",children:["Adicionar Processos ",(0,a.jsx)("span",{"aria-hidden":"true",children:"→"})]}),(0,a.jsxs)(i(),{href:"/pedidos/".concat(null==u?void 0:u.id,"/mao-de-obra"),className:"text-sm font-medium text-blue-700 dark:text-blue-300 hover:text-blue-600 dark:hover:text-blue-200 whitespace-nowrap",children:["Adicionar M\xe3o de Obra ",(0,a.jsx)("span",{"aria-hidden":"true",children:"→"})]}),(0,a.jsxs)(i(),{href:"/pedidos/".concat(null==u?void 0:u.id,"/itens-extras"),className:"text-sm font-medium text-blue-700 dark:text-blue-300 hover:text-blue-600 dark:hover:text-blue-200 whitespace-nowrap",children:["Adicionar Itens Extras ",(0,a.jsx)("span",{"aria-hidden":"true",children:"→"})]})]})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"Detalhes do Pedido"}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["Pedido #",u.id.substring(0,8)," - ",N(u.created_at)]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(i(),{href:"/pedidos",className:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-700 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Voltar"}),(0,a.jsxs)(i(),{href:"/orcamentos?pedido_id=".concat(u.id),className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Gerar Or\xe7amento"]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Informa\xe7\xf5es do Pedido"})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Produto"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:u.produto.nome})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Quantidade"}),(0,a.jsxs)("dd",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:[u.quantidade," unidades"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Status"}),(0,a.jsx)("dd",{className:"mt-1",children:(0,a.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(H.className),children:H.text})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Pre\xe7o Unit\xe1rio"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:k(u.produto.preco_unitario)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Data de Cria\xe7\xe3o"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:N(u.created_at)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"\xdaltima Atualiza\xe7\xe3o"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 dark:text-white",children:N(u.updated_at)})]}),(0,a.jsxs)("div",{className:"sm:col-span-2 lg:col-span-3",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Observa\xe7\xf5es"}),(0,a.jsx)("dd",{className:"mt-1 text-sm text-gray-900 dark:text-white whitespace-pre-wrap",children:u.observacoes||"Nenhuma observa\xe7\xe3o"})]})]})})]}),"finalizado"!==u.status&&"cancelado"!==u.status&&(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Atualizar Status"})}),(0,a.jsxs)("div",{className:"p-6 flex flex-wrap gap-2",children:["pendente"===u.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>w("em_producao"),disabled:f,className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Atualizando...":"Iniciar Produ\xe7\xe3o"}),(0,a.jsx)("button",{onClick:()=>w("cancelado"),disabled:f,className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Atualizando...":"Cancelar Pedido"})]}),"em_producao"===u.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>w("finalizado"),disabled:f,className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Atualizando...":"Finalizar Produ\xe7\xe3o"}),(0,a.jsx)("button",{onClick:()=>w("cancelado"),disabled:f,className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Atualizando...":"Cancelar Pedido"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Processos de Fabrica\xe7\xe3o"}),(0,a.jsx)(i(),{href:"/pedidos/".concat(u.id,"/processos"),className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:u.processos&&u.processos.length>0?"Gerenciar Processos":"Adicionar Processos"})]}),u.processos&&u.processos.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Processo"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Quantidade"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pre\xe7o por Hora"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tempo Estimado (horas)"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Subtotal"})]})}),(0,a.jsxs)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:[u.processos.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.processo.nome}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.quantidade}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:k(e.processo.preco_por_unidade)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:S(e.processo.tempo_estimado_minutos)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:k(e.processo.preco_por_unidade*e.quantidade)})]},e.id)),(0,a.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,a.jsx)("td",{colSpan:4,className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white text-right",children:"Total:"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:k(J)})]})]})]})}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-md flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Nenhum processo adicionado"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:"Este pedido n\xe3o possui processos de fabrica\xe7\xe3o associados. Adicione processos para calcular custos de produ\xe7\xe3o."})]}),(0,a.jsx)(i(),{href:"/pedidos/".concat(u.id,"/processos"),className:"flex-shrink-0 inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Adicionar Agora"})]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"M\xe3o de Obra"}),(0,a.jsx)(i(),{href:"/pedidos/".concat(u.id,"/mao-de-obra"),className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:u.mao_de_obra&&u.mao_de_obra.length>0?"Gerenciar M\xe3o de Obra":"Adicionar M\xe3o de Obra"})]}),u.mao_de_obra&&u.mao_de_obra.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tipo"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Horas"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pre\xe7o por Hora"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Subtotal"})]})}),(0,a.jsxs)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:[u.mao_de_obra.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.mao_de_obra.tipo}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:e.horas.toLocaleString("pt-BR",{minimumFractionDigits:1,maximumFractionDigits:1})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:k(e.mao_de_obra.preco_por_hora)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:k(e.mao_de_obra.preco_por_hora*e.horas)})]},e.id)),(0,a.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,a.jsx)("td",{colSpan:3,className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white text-right",children:"Total:"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:k(G)})]})]})]})}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-md flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Nenhuma m\xe3o de obra adicionada"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:"Este pedido n\xe3o possui m\xe3o de obra associada. Adicione m\xe3o de obra para calcular custos de produ\xe7\xe3o."})]}),(0,a.jsx)(i(),{href:"/pedidos/".concat(u.id,"/mao-de-obra"),className:"flex-shrink-0 inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Adicionar Agora"})]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Itens Extras"}),(0,a.jsx)(i(),{href:"/pedidos/".concat(u.id,"/itens-extras"),className:"inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:u.itens_extras&&u.itens_extras.length>0?"Gerenciar Itens Extras":"Adicionar Itens Extras"})]}),u.itens_extras&&u.itens_extras.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nome"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Descri\xe7\xe3o"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Valor"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Data de Cria\xe7\xe3o"})]})}),(0,a.jsxs)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:[u.itens_extras.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.nome}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-300",children:e.descricao||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:k(e.valor)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:N(e.created_at)})]},e.id)),(0,a.jsxs)("tr",{className:"bg-gray-50 dark:bg-gray-700",children:[(0,a.jsx)("td",{colSpan:3,className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white text-right",children:"Total:"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:k(V)})]})]})]})}):(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 p-4 rounded-md flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Nenhum item extra adicionado"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:"Este pedido n\xe3o possui itens extras. Adicione itens como taxas de urg\xeancia, materiais especiais ou servi\xe7os adicionais."})]}),(0,a.jsx)(i(),{href:"/pedidos/".concat(u.id,"/itens-extras"),className:"flex-shrink-0 inline-flex items-center px-3 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Adicionar Agora"})]})})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Configura\xe7\xf5es de Or\xe7amento"})}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Frete"}),(0,a.jsx)("button",{onClick:()=>M(!I),className:"text-sm text-blue-600 hover:text-blue-500",disabled:R,children:I?"Cancelar":"Editar"})]}),I?(0,a.jsx)(c,{temFrete:u.tem_frete,valorFrete:u.valor_frete,onSave:B,onCancel:()=>M(!1),loading:R}):(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:u.tem_frete?(0,a.jsxs)(a.Fragment,{children:["Tem frete: ",(0,a.jsx)("span",{className:"font-medium",children:k(u.valor_frete)})]}):"Sem frete"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Margem de Lucro"}),(0,a.jsx)("button",{onClick:()=>O(!F),className:"text-sm text-blue-600 hover:text-blue-500",disabled:R,children:F?"Cancelar":"Editar"})]}),F?(0,a.jsx)(x,{margemPercentual:u.margem_lucro_percentual,onSave:U,onCancel:()=>O(!1),loading:R}):(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[u.margem_lucro_percentual,"% (",k(A()),")"]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Impostos"}),(0,a.jsx)("button",{onClick:()=>D(!T),className:"text-sm text-blue-600 hover:text-blue-500",disabled:R,children:T?"Cancelar":"Editar"})]}),T?(0,a.jsx)(m,{impostosPercentual:u.impostos_percentual,onSave:q,onCancel:()=>D(!1),loading:R}):(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[u.impostos_percentual,"% (",k(z()),")"]})})]})]})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Resumo de Custos"})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("dl",{className:"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Custo dos Materiais"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(u.produto.preco_unitario*u.quantidade)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Custo dos Processos"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(J)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Custo da M\xe3o de Obra"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(G)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Custo dos Itens Extras"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(V)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Frete"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(u.tem_frete?u.valor_frete:0)})]}),(0,a.jsxs)("div",{className:"sm:col-span-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Subtotal"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(C())})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:["Margem de Lucro (",u.margem_lucro_percentual,"%)"]}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(A())})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total com Margem"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(P())})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:["Impostos (",u.impostos_percentual,"%)"]}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:k(z())})]}),(0,a.jsxs)("div",{className:"sm:col-span-2 pt-4 border-t-2 border-gray-300 dark:border-gray-600",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total Final"}),(0,a.jsx)("dd",{className:"mt-1 text-3xl font-bold text-gray-900 dark:text-white",children:k((()=>{if(!u)return 0;let e=P(),t=u.impostos_percentual;return t>0?e/((100-t)/100):e})())})]})]})})]})]})}function c(e){let{temFrete:t,valorFrete:r,onSave:d,onCancel:o,loading:i}=e,[l,n]=(0,s.useState)(t),[c,x]=(0,s.useState)(r.toString());return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d(l,parseFloat(c)||0)},className:"mt-3 space-y-3",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:l,onChange:e=>n(e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Tem frete"})]})}),l&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Valor do Frete"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",value:c,onChange:e=>x(e.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0,00"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"submit",disabled:i,className:"px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Salvando...":"Salvar"}),(0,a.jsx)("button",{type:"button",onClick:o,className:"px-3 py-2 bg-gray-300 text-gray-700 text-sm rounded-md hover:bg-gray-400",children:"Cancelar"})]})]})}function x(e){let{margemPercentual:t,onSave:r,onCancel:d,loading:o}=e,[i,l]=(0,s.useState)(t.toString());return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(parseFloat(i)||0)},className:"mt-3 space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Margem de Lucro (%)"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",max:"100",value:i,onChange:e=>l(e.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0,00"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"submit",disabled:o,className:"px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Salvando...":"Salvar"}),(0,a.jsx)("button",{type:"button",onClick:d,className:"px-3 py-2 bg-gray-300 text-gray-700 text-sm rounded-md hover:bg-gray-400",children:"Cancelar"})]})]})}function m(e){let{impostosPercentual:t,onSave:r,onCancel:d,loading:o}=e,[i,l]=(0,s.useState)(t.toString());return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(parseFloat(i)||0)},className:"mt-3 space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Impostos (%)"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",max:"100",value:i,onChange:e=>l(e.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"0,00"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"submit",disabled:o,className:"px-3 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 disabled:opacity-50",children:o?"Salvando...":"Salvar"}),(0,a.jsx)("button",{type:"button",onClick:d,className:"px-3 py-2 bg-gray-300 text-gray-700 text-sm rounded-md hover:bg-gray-400",children:"Cancelar"})]})]})}},25663:(e,t,r)=>{Promise.resolve().then(r.bind(r,7073))},25731:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,Zq:()=>s});var a=r(52643);async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.startsWith("/api/")?e:"/api".concat(e.startsWith("/")?e:"/".concat(e)),s=new Headers(t.headers);if(s.set("Content-Type","application/json"),!1!==t.requireAuth)try{let{data:{session:e}}=await a.Ay.auth.getSession(),r=null==e?void 0:e.access_token;if(r)s.set("Authorization","Bearer ".concat(r));else if(t.requireAuth)throw Error("Autentica\xe7\xe3o necess\xe1ria para acessar este recurso")}catch(e){if(t.requireAuth)throw Error("Falha na autentica\xe7\xe3o")}let d=r;if(t.params){let e=new URLSearchParams;Object.entries(t.params).forEach(t=>{let[r,a]=t;null!=a&&e.append(r,a)});let r=e.toString();r&&(d+="?".concat(r))}try{let e=await fetch(d,{...t,headers:s});if(!e.ok){let t=await e.json().catch(()=>null),r=(null==t?void 0:t.error)||(null==t?void 0:t.message)||"Erro desconhecido";throw Error("Erro ".concat(e.status,": ").concat(r))}let r=e.headers.get("content-type");if(r&&r.includes("application/json"))return await e.json();return await e.text()}catch(e){throw console.error("Erro ao chamar API ".concat(r,":"),e),e}}let d={get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,{...t,method:"GET"})},post(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,{...r,method:"POST",body:JSON.stringify(t)})},put(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,{...r,method:"PUT",body:JSON.stringify(t)})},patch(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,{...r,method:"PATCH",body:JSON.stringify(t)})},delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,{...t,method:"DELETE"})}}},35695:(e,t,r)=>{"use strict";var a=r(18999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},52643:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>i,ND:()=>o});var a=r(10851);let s="https://delvfbrkwsuudzunzdlk.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbHZmYnJrd3N1dWR6dW56ZGxrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NjMxMzIsImV4cCI6MjA2NDAzOTEzMn0.0eq-pFMGWuDHFmzyehrYSLKDP6HY2CBDMsU3ynZpR8g";if(!s||!d)throw Error("As vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY precisam estar configuradas");let o=(0,a.UU)(s,d,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"orcamentos-auth-token"}}),i=o}},e=>{var t=t=>e(e.s=t);e.O(0,[851,6874,8441,1684,7358],()=>t(25663)),_N_E=e.O()}]);