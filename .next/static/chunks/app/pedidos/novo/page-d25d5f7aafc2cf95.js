(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9456],{8810:(e,r,t)=>{Promise.resolve().then(t.bind(t,48818))},25731:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>d,Zq:()=>s});var a=t(52643);async function s(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.startsWith("/api/")?e:"/api".concat(e.startsWith("/")?e:"/".concat(e)),s=new Headers(r.headers);if(s.set("Content-Type","application/json"),!1!==r.requireAuth)try{let{data:{session:e}}=await a.Ay.auth.getSession(),t=null==e?void 0:e.access_token;if(t)s.set("Authorization","Bearer ".concat(t));else if(r.requireAuth)throw Error("Autentica\xe7\xe3o necess\xe1ria para acessar este recurso")}catch(e){if(r.requireAuth)throw Error("Falha na autentica\xe7\xe3o")}let d=t;if(r.params){let e=new URLSearchParams;Object.entries(r.params).forEach(r=>{let[t,a]=r;null!=a&&e.append(t,a)});let t=e.toString();t&&(d+="?".concat(t))}try{let e=await fetch(d,{...r,headers:s});if(!e.ok){let r=await e.json().catch(()=>null),t=(null==r?void 0:r.error)||(null==r?void 0:r.message)||"Erro desconhecido";throw Error("Erro ".concat(e.status,": ").concat(t))}let t=e.headers.get("content-type");if(t&&t.includes("application/json"))return await e.json();return await e.text()}catch(e){throw console.error("Erro ao chamar API ".concat(t,":"),e),e}}let d={get(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,{...r,method:"GET"})},post(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,{...t,method:"POST",body:JSON.stringify(r)})},put(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,{...t,method:"PUT",body:JSON.stringify(r)})},patch(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(e,{...t,method:"PATCH",body:JSON.stringify(r)})},delete(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(e,{...r,method:"DELETE"})}}},35695:(e,r,t)=>{"use strict";var a=t(18999);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},48818:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var a=t(95155),s=t(12115),d=t(35695),o=t(6874),i=t.n(o),l=t(25731);function n(){let e=(0,d.useRouter)(),[r,t]=(0,s.useState)(!1),[o,n]=(0,s.useState)(!0),[c,u]=(0,s.useState)(null),[m,h]=(0,s.useState)([]),[x,p]=(0,s.useState)({produto_id:"",quantidade:"",observacoes:""});(0,s.useEffect)(()=>{(async()=>{n(!0);try{let e=await l.Ay.get("/produtos",{params:{materiaPrima:"false"}});h(e.data||[])}catch(e){console.error("Erro ao buscar produtos:",e),u("N\xe3o foi poss\xedvel carregar a lista de produtos. Tente novamente mais tarde.")}finally{n(!1)}})()},[]);let b=e=>{let{name:r,value:t}=e.target;if("quantidade"===r){let e=t.replace(/\D/g,"");p({...x,[r]:e})}else p({...x,[r]:t})},g=async r=>{r.preventDefault(),t(!0),u(null);try{var a;if(!x.produto_id)throw Error("Selecione um produto");if(!x.quantidade||0>=parseInt(x.quantidade))throw Error("A quantidade deve ser maior que zero");let r={...x,quantidade:parseInt(x.quantidade)},t=null==(a=(await l.Ay.post("/pedidos",r)).data)?void 0:a.id;t?e.push("/pedidos/".concat(t,"?novo=true")):e.push("/pedidos")}catch(e){console.error("Erro ao criar pedido:",e),u(e instanceof Error?e.message:"Ocorreu um erro ao criar o pedido")}finally{t(!1)}},f=x.produto_id?m.find(e=>e.id===x.produto_id):null;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"Novo Pedido"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Crie um novo pedido de fabrica\xe7\xe3o"})]}),(0,a.jsx)(i(),{href:"/pedidos",className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-700 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancelar"})]}),c&&(0,a.jsx)("div",{className:"rounded-md bg-red-50 dark:bg-red-900/30 p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Erro ao criar pedido"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-red-700 dark:text-red-300",children:(0,a.jsx)("p",{children:c})})]})]})}),(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:(0,a.jsxs)("form",{onSubmit:g,className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6",children:[(0,a.jsxs)("div",{className:"sm:col-span-4",children:[(0,a.jsx)("label",{htmlFor:"produto_id",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Produto"}),(0,a.jsx)("div",{className:"mt-1",children:o?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin h-5 w-5 mr-3 border-t-2 border-b-2 border-blue-600 rounded-full"}),(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Carregando produtos..."})]}):(0,a.jsxs)("select",{id:"produto_id",name:"produto_id",required:!0,value:x.produto_id,onChange:b,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md",children:[(0,a.jsx)("option",{value:"",children:"Selecione um produto"}),m.map(e=>(0,a.jsx)("option",{value:e.id,children:e.nome},e.id))]})})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{htmlFor:"quantidade",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Quantidade"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("input",{type:"text",name:"quantidade",id:"quantidade",required:!0,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md",placeholder:"1",value:x.quantidade,onChange:b})})]}),(0,a.jsxs)("div",{className:"sm:col-span-6",children:[(0,a.jsx)("label",{htmlFor:"observacoes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Observa\xe7\xf5es"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("textarea",{id:"observacoes",name:"observacoes",rows:3,className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md",placeholder:"Observa\xe7\xf5es adicionais sobre o pedido",value:x.observacoes,onChange:b})}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Adicione informa\xe7\xf5es relevantes sobre o pedido, como especifica\xe7\xf5es especiais ou prazos."})]})]}),f&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Detalhes do Produto"}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-1 gap-x-4 gap-y-2 sm:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Pre\xe7o Unit\xe1rio"}),(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(f.preco_unitario)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Estoque Dispon\xedvel"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:[f.quantidade_estoque," unidades"]})]}),(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Descri\xe7\xe3o"}),(0,a.jsx)("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:f.descricao})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("button",{type:"button",onClick:()=>e.push("/pedidos"),className:"mr-3 px-4 py-2 border border-gray-300 dark:border-gray-700 shadow-sm text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:r||o,className:"inline-flex justify-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Criando...":"Criar Pedido"})]}),(0,a.jsx)("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:(0,a.jsx)("p",{children:"Ap\xf3s criar o pedido, voc\xea poder\xe1 adicionar processos de fabrica\xe7\xe3o e m\xe3o de obra necess\xe1rios."})})]})})]})}},52643:(e,r,t)=>{"use strict";t.d(r,{Ay:()=>i,ND:()=>o});var a=t(10851);let s="https://delvfbrkwsuudzunzdlk.supabase.co",d="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbHZmYnJrd3N1dWR6dW56ZGxrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NjMxMzIsImV4cCI6MjA2NDAzOTEzMn0.0eq-pFMGWuDHFmzyehrYSLKDP6HY2CBDMsU3ynZpR8g";if(!s||!d)throw Error("As vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY precisam estar configuradas");let o=(0,a.UU)(s,d,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"orcamentos-auth-token"}}),i=o}},e=>{var r=r=>e(e.s=r);e.O(0,[851,6874,8441,1684,7358],()=>r(8810)),_N_E=e.O()}]);