(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3921],{35695:(e,r,a)=>{"use strict";var s=a(18999);a.o(s,"usePathname")&&a.d(r,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(r,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(r,{useSearchParams:function(){return s.useSearchParams}})},52643:(e,r,a)=>{"use strict";a.d(r,{Ay:()=>o,ND:()=>d});var s=a(10851);let t="https://delvfbrkwsuudzunzdlk.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbHZmYnJrd3N1dWR6dW56ZGxrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NjMxMzIsImV4cCI6MjA2NDAzOTEzMn0.0eq-pFMGWuDHFmzyehrYSLKDP6HY2CBDMsU3ynZpR8g";if(!t||!l)throw Error("As vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY precisam estar configuradas");let d=(0,s.UU)(t,l,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"orcamentos-auth-token"}}),o=d},62679:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>o});var s=a(95155),t=a(12115),l=a(52643),d=a(35695);function o(){let[e,r]=(0,t.useState)(null),[a,o]=(0,t.useState)(!0),[i,n]=(0,t.useState)(!1),[u,c]=(0,t.useState)(null),[m,x]=(0,t.useState)(null),h=(0,d.useRouter)(),[g,b]=(0,t.useState)(""),[p,f]=(0,t.useState)(""),[y,k]=(0,t.useState)(""),[N,v]=(0,t.useState)("");(0,t.useEffect)(()=>{(async()=>{o(!0),c(null);try{let{data:{session:e}}=await l.Ay.auth.getSession();if(!e)return void h.push("/login");let{data:a,error:s}=await l.Ay.from("profiles").select("*").eq("id",e.user.id).single();if(s)throw s;a&&(r(a),b(a.nome||""),f(a.empresa||""),k(a.cargo||""),v(a.telefone||""))}catch(e){console.error("Erro ao buscar perfil:",e),c("N\xe3o foi poss\xedvel carregar os dados do perfil. Tente novamente mais tarde.")}finally{o(!1)}})()},[h]);let j=async a=>{a.preventDefault(),n(!0),c(null),x(null);try{let{data:{session:a}}=await l.Ay.auth.getSession();if(!a)return void h.push("/login");let{error:s}=await l.Ay.from("profiles").update({nome:g,empresa:p,cargo:y,telefone:N,updated_at:new Date().toISOString()}).eq("id",a.user.id);if(s)throw s;x("Perfil atualizado com sucesso!"),r({...e,nome:g,empresa:p,cargo:y,telefone:N})}catch(e){console.error("Erro ao atualizar perfil:",e),c("N\xe3o foi poss\xedvel atualizar o perfil. Tente novamente mais tarde.")}finally{n(!1),m&&setTimeout(()=>{x(null)},3e3)}};return a?(0,s.jsx)("div",{className:"p-4 flex justify-center items-center h-full",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})}):(0,s.jsx)("div",{className:"max-w-2xl mx-auto",suppressHydrationWarning:!0,children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-gray-900 dark:text-white",children:"Meu Perfil"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Atualize suas informa\xe7\xf5es pessoais"})]}),u&&(0,s.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/30 p-4 rounded-md",children:[(0,s.jsx)("h2",{className:"text-red-800 dark:text-red-200 font-medium",children:"Erro"}),(0,s.jsx)("p",{className:"text-red-700 dark:text-red-300 mt-1",children:u})]}),m&&(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/30 p-4 rounded-md",children:[(0,s.jsx)("h2",{className:"text-green-800 dark:text-green-200 font-medium",children:"Sucesso"}),(0,s.jsx)("p",{className:"text-green-700 dark:text-green-300 mt-1",children:m})]}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-6",suppressHydrationWarning:!0,children:(0,s.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email"}),(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("input",{type:"email",id:"email",className:"shadow-sm bg-gray-100 dark:bg-gray-700 focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 cursor-not-allowed",value:null==e?void 0:e.id,disabled:!0,readOnly:!0}),(0,s.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"O email n\xe3o pode ser alterado"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nome Completo *"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("input",{type:"text",id:"nome",className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md py-2 px-3",value:g,onChange:e=>b(e.target.value),required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"empresa",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Empresa"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("input",{type:"text",id:"empresa",className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md py-2 px-3",value:p,onChange:e=>f(e.target.value)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"cargo",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cargo / Fun\xe7\xe3o"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("input",{type:"text",id:"cargo",className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md py-2 px-3",value:y,onChange:e=>k(e.target.value)})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"telefone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Telefone"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)("input",{type:"tel",id:"telefone",className:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md py-2 px-3",value:N,onChange:e=>v(e.target.value),placeholder:"(00) 00000-0000"})})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:i,children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]}):"Salvar Altera\xe7\xf5es"})})]})})]})})}},71310:(e,r,a)=>{Promise.resolve().then(a.bind(a,62679))}},e=>{var r=r=>e(e.s=r);e.O(0,[851,8441,1684,7358],()=>r(71310)),_N_E=e.O()}]);