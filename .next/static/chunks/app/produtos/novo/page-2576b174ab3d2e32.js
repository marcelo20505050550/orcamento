(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7834],{9458:(e,t,a)=>{"use strict";a.d(t,{HW:()=>i,Wq:()=>r,_h:()=>o,qQ:()=>l,ri:()=>n,wR:()=>c,xw:()=>u});var s=a(52643);async function o(e){let{email:t,password:a}=e,{data:o,error:r}=await s.ND.auth.signInWithPassword({email:t,password:a});return{user:(null==o?void 0:o.user)||null,session:(null==o?void 0:o.session)||null,error:r}}async function r(e){let{email:t,password:a,nome:o}=e,{data:r,error:n}=await s.ND.auth.signUp({email:t,password:a,options:{data:{nome:o}}});return{user:(null==r?void 0:r.user)||null,session:(null==r?void 0:r.session)||null,error:n}}async function n(){let{error:e}=await s.ND.auth.signOut();return!e}async function i(){let{data:{user:e}}=await s.ND.auth.getUser();return e}async function l(){let{data:{session:e}}=await s.ND.auth.getSession();return e}async function c(){return!!await l()}async function u(e){let{error:t}=await s.ND.auth.resetPasswordForEmail(e);return!t}},25731:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>r,Zq:()=>o});var s=a(52643);async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.startsWith("/api/")?e:"/api".concat(e.startsWith("/")?e:"/".concat(e)),o=new Headers(t.headers);if(o.set("Content-Type","application/json"),!1!==t.requireAuth)try{let{data:{session:e}}=await s.Ay.auth.getSession(),a=null==e?void 0:e.access_token;if(a)o.set("Authorization","Bearer ".concat(a));else if(t.requireAuth)throw Error("Autentica\xe7\xe3o necess\xe1ria para acessar este recurso")}catch(e){if(t.requireAuth)throw Error("Falha na autentica\xe7\xe3o")}let r=a;if(t.params){let e=new URLSearchParams;Object.entries(t.params).forEach(t=>{let[a,s]=t;null!=s&&e.append(a,s)});let a=e.toString();a&&(r+="?".concat(a))}try{let e=await fetch(r,{...t,headers:o});if(!e.ok){let t=await e.json().catch(()=>null),a=(null==t?void 0:t.error)||(null==t?void 0:t.message)||"Erro desconhecido";throw Error("Erro ".concat(e.status,": ").concat(a))}let a=e.headers.get("content-type");if(a&&a.includes("application/json"))return await e.json();return await e.text()}catch(e){throw console.error("Erro ao chamar API ".concat(a,":"),e),e}}let r={get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(e,{...t,method:"GET"})},post(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(e,{...a,method:"POST",body:JSON.stringify(t)})},put(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(e,{...a,method:"PUT",body:JSON.stringify(t)})},patch(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o(e,{...a,method:"PATCH",body:JSON.stringify(t)})},delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(e,{...t,method:"DELETE"})}}},35695:(e,t,a)=>{"use strict";var s=a(18999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},47460:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(95155),o=a(12115),r=a(35695),n=a(6874),i=a.n(n),l=a(25731),c=a(9458);function u(){let e=(0,r.useRouter)(),[t,a]=(0,o.useState)(!1),[n,u]=(0,o.useState)(null),[d,h]=(0,o.useState)({nome:"",descricao:"",preco_unitario:"",quantidade_estoque:"",e_materia_prima:!1});(0,o.useEffect)(()=>{(async()=>{let t=await (0,c.qQ)();console.log("Estado da sess\xe3o:",t?"Autenticado":"N\xe3o autenticado"),t||(console.log("Usu\xe1rio n\xe3o autenticado, redirecionando para login..."),e.push("/login"))})()},[e]);let m=e=>{let{name:t,value:a,type:s}=e.target;if("checkbox"===s){let a=e.target;h({...d,[t]:a.checked})}else if("preco_unitario"===t||"quantidade_estoque"===t){let e=a.replace(/[^\d.]/g,"");h({...d,[t]:e})}else h({...d,[t]:a})},p=async t=>{t.preventDefault(),a(!0),u(null);try{console.log("Enviando dados do produto:",d);let t=await (0,c.qQ)();if(console.log("Status da autentica\xe7\xe3o antes do envio:",t?"Autenticado":"N\xe3o autenticado"),!t)throw Error("Usu\xe1rio n\xe3o autenticado. Fa\xe7a login para continuar.");let a={...d,preco_unitario:d.preco_unitario?parseFloat(d.preco_unitario):0,quantidade_estoque:parseFloat(d.quantidade_estoque)||0},s=await l.Ay.post("/produtos",a);console.log("Resposta da API:",s),e.push("/produtos")}catch(e){console.error("Erro ao cadastrar produto:",e),u(e instanceof Error?e.message:"Erro ao cadastrar produto")}finally{a(!1)}};return(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Novo Produto"}),(0,s.jsx)(i(),{href:"/produtos",className:"bg-gray-200 px-4 py-2 rounded hover:bg-gray-300",children:"Voltar"})]}),n&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:(0,s.jsx)("p",{children:n})}),(0,s.jsxs)("form",{onSubmit:p,className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"nome",children:["Nome",(0,s.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,s.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"nome",type:"text",name:"nome",value:d.nome,onChange:m,required:!0})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"descricao",children:"Descri\xe7\xe3o"}),(0,s.jsx)("textarea",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"descricao",name:"descricao",value:d.descricao,onChange:m,rows:3})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"preco_unitario",children:["Pre\xe7o Unit\xe1rio (R$)",d.e_materia_prima&&(0,s.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,s.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"preco_unitario",type:"text",name:"preco_unitario",value:d.preco_unitario,onChange:m,required:d.e_materia_prima})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"quantidade_estoque",children:"Estoque Inicial"}),(0,s.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"quantidade_estoque",type:"text",name:"quantidade_estoque",value:d.quantidade_estoque,onChange:m})]}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",name:"e_materia_prima",checked:d.e_materia_prima,onChange:m,className:"mr-2"}),(0,s.jsx)("span",{className:"text-gray-700 text-sm font-bold",children:"\xc9 mat\xe9ria-prima?"})]})}),(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",disabled:t,children:t?"Salvando...":"Salvar"})}),(0,s.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:[(0,s.jsx)("span",{className:"text-red-500",children:"*"})," Campos obrigat\xf3rios"]})]})]})}},52643:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>i,ND:()=>n});var s=a(10851);let o="https://delvfbrkwsuudzunzdlk.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbHZmYnJrd3N1dWR6dW56ZGxrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NjMxMzIsImV4cCI6MjA2NDAzOTEzMn0.0eq-pFMGWuDHFmzyehrYSLKDP6HY2CBDMsU3ynZpR8g";if(!o||!r)throw Error("As vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY precisam estar configuradas");let n=(0,s.UU)(o,r,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"orcamentos-auth-token"}}),i=n},96036:(e,t,a)=>{Promise.resolve().then(a.bind(a,47460))}},e=>{var t=t=>e(e.s=t);e.O(0,[851,6874,8441,1684,7358],()=>t(96036)),_N_E=e.O()}]);