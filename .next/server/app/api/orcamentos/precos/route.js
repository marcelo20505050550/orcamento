(()=>{var e={};e.id=4122,e.ids=[4122],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},21043:(e,r,o)=>{"use strict";o.r(r),o.d(r,{patchFetch:()=>x,routeModule:()=>m,serverHooks:()=>f,workAsyncStorage:()=>_,workUnitAsyncStorage:()=>h});var s={};o.r(s),o.d(s,{PATCH:()=>l});var t=o(96559),a=o(48088),i=o(37719),u=o(32190),n=o(63511),p=o(96890),d=o(86481);function c(e){return"number"==typeof e&&e>=0}let l=(0,p.ru)(async e=>{try{let r=await e.json();if(!r.produtos&&!r.processos&&!r.mao_de_obra)return u.NextResponse.json({error:"Nenhum item para atualiza\xe7\xe3o foi fornecido"},{status:400});let o=e.headers.get("authorization").split(" ")[1],{data:{user:s},error:t}=await n.ND.auth.getUser(o);if(t||!s)return u.NextResponse.json({error:"Erro ao identificar o usu\xe1rio"},{status:401});let a={produtos:{sucesso:0,erros:0,detalhes:[]},processos:{sucesso:0,erros:0,detalhes:[]},mao_de_obra:{sucesso:0,erros:0,detalhes:[]}};if(r.produtos&&r.produtos.length>0)for(let e of r.produtos){if(!e.id||!c(e.preco_unitario)){a.produtos.erros++,a.produtos.detalhes.push({id:e.id||"ID inv\xe1lido",erro:"ID ou pre\xe7o unit\xe1rio inv\xe1lido"});continue}let{data:r,error:o}=await n.ND.from("produtos").update({preco_unitario:e.preco_unitario}).eq("id",e.id).select("id, nome").single();o?(a.produtos.erros++,a.produtos.detalhes.push({id:e.id,erro:o.message})):(a.produtos.sucesso++,a.produtos.detalhes.push({id:e.id,nome:r?.nome,preco_atualizado:e.preco_unitario}))}if(r.processos&&r.processos.length>0)for(let e of r.processos){if(!e.id||!c(e.preco_por_unidade)){a.processos.erros++,a.processos.detalhes.push({id:e.id||"ID inv\xe1lido",erro:"ID ou pre\xe7o por unidade inv\xe1lido"});continue}let{data:r,error:o}=await n.ND.from("processos_fabricacao").update({preco_por_unidade:e.preco_por_unidade}).eq("id",e.id).select("id, nome").single();o?(a.processos.erros++,a.processos.detalhes.push({id:e.id,erro:o.message})):(a.processos.sucesso++,a.processos.detalhes.push({id:e.id,nome:r?.nome,preco_atualizado:e.preco_por_unidade}))}if(r.mao_de_obra&&r.mao_de_obra.length>0)for(let e of r.mao_de_obra){if(!e.id||!c(e.preco_por_hora)){a.mao_de_obra.erros++,a.mao_de_obra.detalhes.push({id:e.id||"ID inv\xe1lido",erro:"ID ou pre\xe7o por hora inv\xe1lido"});continue}let{data:r,error:o}=await n.ND.from("mao_de_obra").update({preco_por_hora:e.preco_por_hora}).eq("id",e.id).select("id, tipo").single();o?(a.mao_de_obra.erros++,a.mao_de_obra.detalhes.push({id:e.id,erro:o.message})):(a.mao_de_obra.sucesso++,a.mao_de_obra.detalhes.push({id:e.id,tipo:r?.tipo,preco_atualizado:e.preco_por_hora}))}let i=a.produtos.sucesso+a.processos.sucesso+a.mao_de_obra.sucesso,p=a.produtos.erros+a.processos.erros+a.mao_de_obra.erros;return(0,d.fH)(`Atualiza\xe7\xe3o de pre\xe7os conclu\xedda: ${i} itens atualizados com sucesso, ${p} erros`),u.NextResponse.json({message:`Atualiza\xe7\xe3o de pre\xe7os conclu\xedda: ${i} itens atualizados com sucesso, ${p} erros`,data:a})}catch(e){return(0,d.vV)("Erro n\xe3o tratado ao atualizar pre\xe7os",e),u.NextResponse.json({error:"Erro interno ao processar a requisi\xe7\xe3o"},{status:500})}}),m=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/orcamentos/precos/route",pathname:"/api/orcamentos/precos",filename:"route",bundlePath:"app/api/orcamentos/precos/route"},resolvedPagePath:"C:\\Aplicativos\\saas\\src\\app\\api\\orcamentos\\precos\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:_,workUnitAsyncStorage:h,serverHooks:f}=m;function x(){return(0,i.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:h})}},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},41204:e=>{"use strict";e.exports=require("string_decoder")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63511:(e,r,o)=>{"use strict";o.d(r,{ND:()=>i});var s=o(86345);let t="https://delvfbrkwsuudzunzdlk.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbHZmYnJrd3N1dWR6dW56ZGxrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NjMxMzIsImV4cCI6MjA2NDAzOTEzMn0.0eq-pFMGWuDHFmzyehrYSLKDP6HY2CBDMsU3ynZpR8g";if(!t||!a)throw Error("As vari\xe1veis de ambiente NEXT_PUBLIC_SUPABASE_URL e NEXT_PUBLIC_SUPABASE_ANON_KEY precisam estar configuradas");let i=(0,s.UU)(t,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"orcamentos-auth-token"}})},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},86481:(e,r,o)=>{"use strict";o.d(r,{Ay:()=>h,fH:()=>m,vV:()=>_});var s=o(91728),t=o.n(s);let{format:a,transports:i}=t(),{combine:u,timestamp:n,printf:p,colorize:d}=a,c=p(({level:e,message:r,timestamp:o})=>`[${o}] ${e}: ${r}`),l=t().createLogger({level:"info",format:u(n({format:"YYYY-MM-DD HH:mm:ss"}),c),transports:[new i.Console({format:u(d(),n({format:"YYYY-MM-DD HH:mm:ss"}),c)}),new i.File({filename:"logs/error.log",level:"error"}),new i.File({filename:"logs/combined.log"})]}),m=(e,r)=>{l.info(r?`${e} ${JSON.stringify(r)}`:e)},_=(e,r)=>{r instanceof Error?l.error(`${e}: ${r.message}`,{stack:r.stack}):r?l.error(`${e}: ${JSON.stringify(r)}`):l.error(e)},h=l},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{},96890:(e,r,o)=>{"use strict";o.d(r,{fS:()=>u,ru:()=>n});var s=o(32190),t=o(86345),a=o(86481);async function i(e){try{let r=(0,t.UU)("https://delvfbrkwsuudzunzdlk.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{persistSession:!1,autoRefreshToken:!1}}),o=e.headers.get("authorization");if(!o||!o.startsWith("Bearer "))return s.NextResponse.json({error:"Token de autentica\xe7\xe3o n\xe3o fornecido"},{status:401});let a=o.split(" ")[1],{data:i,error:u}=await r.auth.getUser(a);if(u||!i.user)return console.error("Erro de autentica\xe7\xe3o:",u),s.NextResponse.json({error:"Token de autentica\xe7\xe3o inv\xe1lido ou expirado"},{status:401});return null}catch(e){return(0,a.vV)("Erro no middleware de autentica\xe7\xe3o",e),s.NextResponse.json({error:"Erro ao processar autentica\xe7\xe3o"},{status:500})}}function u(e){return async(r,...o)=>{try{return await e(r,...o)}catch(e){return(0,a.vV)("Erro n\xe3o tratado na API",e),s.NextResponse.json({error:"Ocorreu um erro ao processar a requisi\xe7\xe3o",message:e instanceof Error?e.message:"Erro desconhecido"},{status:500})}}}function n(e){return async(r,o)=>{let s=await i(r);return s||u(e)(r,o)}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),s=r.X(0,[4447,580,4296],()=>o(21043));module.exports=s})();